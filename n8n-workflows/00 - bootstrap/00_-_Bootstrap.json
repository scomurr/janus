[{"createdAt":"2025-09-09T16:12:14.734Z","updatedAt":"2025-09-17T03:10:45.000Z","id":"LzB1EMVb6HSKPKh6","name":"00 - Bootstrap","active":false,"isArchived":false,"nodes":[{"parameters":{},"type":"n8n-nodes-base.manualTrigger","typeVersion":1,"position":[-736,-208],"id":"7eeda6d0-3a9c-4774-a50c-560759f7294a","name":"When clicking ‘Execute workflow’"},{"parameters":{"operation":"executeQuery","query":"CREATE TABLE IF NOT EXISTS ticker_universe (\n  symbol TEXT PRIMARY KEY,\n  name TEXT,\n  exchange TEXT,\n  market_cap BIGINT,\n  volume BIGINT,\n  trailing_pe DOUBLE PRECISION,\n  fifty_two_week_high DOUBLE PRECISION,\n  fifty_two_week_low DOUBLE PRECISION,\n  dividend_yield DOUBLE PRECISION,\n  total_revenue BIGINT,\n  gross_margins DOUBLE PRECISION,\n  info_raw JSONB,\n  last_updated TIMESTAMP,\n  last_scanned TIMESTAMP\n);\n","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-512,-208],"id":"1e3fefa3-e416-41de-b9aa-681e224e6605","name":"Create ticker_universe","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"operation":"executeQuery","query":"CREATE TABLE IF NOT EXISTS ticker_scores (\nsymbol TEXT PRIMARY KEY,\nscore INTEGER,\nrecommendation TEXT,\nreason TEXT,\nlast_updated TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);\n","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-288,-208],"id":"9fb68510-e09b-4676-9e1b-906ac8f812b9","name":"Create ticker_scores","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"operation":"executeQuery","query":"CREATE TABLE IF NOT EXISTS ticker_buys (\n  symbol TEXT PRIMARY KEY,\n  thesis TEXT,                  -- Original alpha thesis\n  original_conviction INTEGER, -- Initial conviction score (frozen)\n  last_conviction INTEGER,     -- Previous conviction score\n  conviction INTEGER,          -- Current conviction score\n  last_updated TIMESTAMP       -- Timestamp of last update\n);\n","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[-64,-208],"id":"6b1fc482-9156-40b6-9086-d1465bca607e","name":"Create ticker_buys","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"operation":"executeQuery","query":"CREATE TABLE IF NOT EXISTS daily_prices (\n    id SERIAL PRIMARY KEY,\n    symbol TEXT NOT NULL,\n    date DATE NOT NULL,\n    price_open DECIMAL(10,2),\n    price_1hr_after_open DECIMAL(10,2),\n    price_close DECIMAL(10,2),\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    UNIQUE(symbol, date)\n);","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[160,-208],"id":"3f05e1ac-a9d5-4320-81bb-7a4204bd01fd","name":"Create daily_prices Table","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"operation":"executeQuery","query":"CREATE TABLE IF NOT EXISTS portfolio_positions  (\n  id SERIAL PRIMARY KEY,\n  timestamp TIMESTAMP DEFAULT now(),\n  symbol TEXT NOT NULL,\n  allocation_usd NUMERIC(10,2),\n  conviction INTEGER,\n  total_portfolio_value NUMERIC(10,2),\n  notes TEXT\n);\n","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[384,-208],"id":"17384768-d9ca-4c3c-b05a-a85a32a61a62","name":"Create portfolio_positions Table if Missing","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"operation":"executeQuery","query":"CREATE TABLE IF NOT EXISTS daily_valuation (\n    id SERIAL PRIMARY KEY,\n    date DATE NOT NULL,\n    symbol TEXT NOT NULL,\n    strategy VARCHAR(20) NOT NULL,      -- 'hold', 'daily', 'weekly'\n    trade_session_id VARCHAR(50),       -- For grouping multi-day positions\n    allocation_usd DECIMAL(15,2),       -- Original USD allocation\n    quantity_held DECIMAL(15,6),        -- Number of shares\n    entry_price DECIMAL(10,2),          -- Price at position entry\n    current_price DECIMAL(10,2),        -- Current price (varies by strategy)\n    value_close DECIMAL(15,2),          -- Current position value\n    profit_loss DECIMAL(15,2),          -- P&L vs original allocation\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    UNIQUE(date, symbol, strategy)\n);","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[832,-208],"id":"467b99c2-257d-4153-89a3-725041947752","name":"Create daily_valuation Table if Missing","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"operation":"executeQuery","query":"CREATE TABLE IF NOT EXISTS price_snapshots (\n    id SERIAL PRIMARY KEY,\n    symbol TEXT NOT NULL,\n    date DATE NOT NULL,\n    price_open DECIMAL(10,2),           -- 9:30 AM Central\n    price_1hr_after_open DECIMAL(10,2), -- 10:30 AM Central  \n    price_close DECIMAL(10,2),          -- 4:00 PM Central\n    created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n    UNIQUE(symbol, date)\n);","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[608,-208],"id":"abd1274e-ae2b-4586-af7c-3527d25abb09","name":"Create price_snapshots Table if Missing","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"content":"We need to add $1000 into the daily_positions table in order to seed this\n"},"type":"n8n-nodes-base.stickyNote","position":[-544,16],"typeVersion":1,"id":"d7e78a26-1bac-48c1-9035-5fa1775d4d46","name":"Sticky Note"},{"parameters":{"operation":"executeQuery","query":"CREATE TABLE IF NOT EXISTS daily_positions (\n  id SERIAL PRIMARY KEY,\n  symbol TEXT NOT NULL,\n  date DATE NOT NULL,\n  shares_bought DECIMAL(15,6) DEFAULT 0,\n  shares_sold DECIMAL(15,6) DEFAULT 0,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  UNIQUE(symbol, date)\n);","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[1056,-208],"id":"6464bc60-d89e-4c4a-a9b5-045056c010bc","name":"Create daily_positions Table","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"operation":"executeQuery","query":"CREATE TABLE IF NOT EXISTS weekly_positions (\n  id SERIAL PRIMARY KEY,\n  symbol TEXT NOT NULL,\n  date DATE NOT NULL,\n  shares_bought DECIMAL(15,6) DEFAULT 0,\n  shares_sold DECIMAL(15,6) DEFAULT 0,\n  buy_price DECIMAL(15,6),\n  sell_price DECIMAL(15,6),\n  conviction_at_buy DECIMAL(5,2),\n  conviction_at_sell DECIMAL(5,2),\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  UNIQUE(symbol, date, shares_bought, shares_sold)\n);","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[1280,-208],"id":"c80f373c-cac9-4adb-b862-8efe0135cd60","name":"Create weekly_positions Table","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"operation":"executeQuery","query":"DO $$\nBEGIN\n  IF NOT EXISTS (SELECT 1 FROM weekly_positions WHERE symbol = 'USDW') THEN\n    INSERT INTO weekly_positions (symbol, date, shares_bought, conviction_at_buy, created_at)\n    VALUES ('USDW', '2024-09-07', 1000.00, 0, NOW());\n  END IF;\nEND $$;","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[1504,-208],"id":"f80bfcb2-0d8e-4e1d-8878-984b2608c481","name":"Seed USDW Cash if New Table","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"content":"We need to add $1000 into the weekly_positions table in order to seed this\n"},"type":"n8n-nodes-base.stickyNote","position":[1424,16],"typeVersion":1,"id":"683ade72-1e34-4b09-82a3-f3207c923001","name":"Sticky Note1"},{"parameters":{"operation":"executeQuery","query":"CREATE TABLE IF NOT EXISTS hold_positions (\n  id SERIAL PRIMARY KEY,\n  symbol TEXT NOT NULL,\n  date DATE NOT NULL,\n  shares_bought DECIMAL(15,6) DEFAULT 0,\n  shares_sold DECIMAL(15,6) DEFAULT 0,\n  buy_price DECIMAL(15,6),\n  sell_price DECIMAL(15,6),\n  conviction_at_buy DECIMAL(5,2),\n  conviction_at_sell DECIMAL(5,2),\n  rebalance_reason TEXT,\n  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,\n  updated_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP\n);","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[1728,-208],"id":"87dd40f5-cc9e-4118-90bf-08207aa6db51","name":"Create hold_positions Table","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"operation":"executeQuery","query":"DO $$\nBEGIN\n  IF NOT EXISTS (SELECT 1 FROM hold_positions WHERE symbol = 'USDH') THEN\n    INSERT INTO hold_positions (symbol, date, shares_bought, conviction_at_buy, rebalance_reason, created_at)\n    VALUES ('USDH', '2024-09-08', 1000.00, 0, 'Initial seed capital', NOW());\n  END IF;\nEND $$;","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[1952,-208],"id":"eb1d2363-dda8-4ebb-8da5-3737c3993810","name":"Seed USDH Cash if New Table","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}},{"parameters":{"operation":"executeQuery","query":"CREATE TABLE IF NOT EXISTS company_news (\n  datetime    BIGINT      NOT NULL,\n  id          BIGINT      PRIMARY KEY,\n  symbol      VARCHAR(16) NOT NULL,\n  sentiment   VARCHAR(16),\n  summary     TEXT,\n  headline    TEXT        NOT NULL,\n  url         TEXT        NOT NULL\n);\n","options":{}},"type":"n8n-nodes-base.postgres","typeVersion":2.6,"position":[2176,-208],"id":"42349fa9-90d9-41bb-8a76-6666a4bcad9e","name":"Create company_news","credentials":{"postgres":{"id":"MI553DLfDKBYBMXy","name":"Postgres account"}}}],"connections":{"When clicking ‘Execute workflow’":{"main":[[{"node":"Create ticker_universe","type":"main","index":0}]]},"Create ticker_universe":{"main":[[{"node":"Create ticker_scores","type":"main","index":0}]]},"Create ticker_scores":{"main":[[{"node":"Create ticker_buys","type":"main","index":0}]]},"Create ticker_buys":{"main":[[{"node":"Create daily_prices Table","type":"main","index":0}]]},"Create portfolio_positions Table if Missing":{"main":[[{"node":"Create price_snapshots Table if Missing","type":"main","index":0}]]},"Create price_snapshots Table if Missing":{"main":[[{"node":"Create daily_valuation Table if Missing","type":"main","index":0}]]},"Create daily_prices Table":{"main":[[{"node":"Create portfolio_positions Table if Missing","type":"main","index":0}]]},"Create daily_valuation Table if Missing":{"main":[[{"node":"Create daily_positions Table","type":"main","index":0}]]},"Create weekly_positions Table":{"main":[[{"node":"Seed USDW Cash if New Table","type":"main","index":0}]]},"Create daily_positions Table":{"main":[[{"node":"Create weekly_positions Table","type":"main","index":0}]]},"Create hold_positions Table":{"main":[[{"node":"Seed USDH Cash if New Table","type":"main","index":0}]]},"Seed USDW Cash if New Table":{"main":[[{"node":"Create hold_positions Table","type":"main","index":0}]]},"Seed USDH Cash if New Table":{"main":[[{"node":"Create company_news","type":"main","index":0}]]}},"settings":{"executionOrder":"v1"},"staticData":null,"meta":null,"pinData":{},"versionId":"34984761-22c7-4a08-85d2-303f9b9a9389","triggerCount":0,"tags":[{"createdAt":"2025-09-04T15:23:38.975Z","updatedAt":"2025-09-04T15:23:38.975Z","id":"yQaAGmyd3yVCL790","name":"janus"}],"shared":[{"createdAt":"2025-09-09T16:12:14.740Z","updatedAt":"2025-09-09T16:12:14.740Z","role":"workflow:owner","workflowId":"LzB1EMVb6HSKPKh6","projectId":"33RSXH6V1FUTQaMQ","project":{"createdAt":"2025-08-29T14:57:46.722Z","updatedAt":"2025-08-29T15:00:17.904Z","id":"33RSXH6V1FUTQaMQ","name":"Scott Murray <scomurr@scomurr.com>","type":"personal","icon":null,"description":null}}]}]