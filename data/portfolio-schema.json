{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Portfolio Schema",
  "description": "Schema for portfolio data structure",
  "type": "object",
  "properties": {
    "metadata": {
      "type": "object",
      "properties": {
        "lastUpdated": {
          "type": "string",
          "format": "date-time"
        },
        "version": {
          "type": "string"
        },
        "source": {
          "type": "string",
          "enum": ["csv", "database", "api"]
        }
      }
    },
    "summary": {
      "type": "object",
      "properties": {
        "cash": {
          "type": "number",
          "minimum": 0
        },
        "totalEquity": {
          "type": "number",
          "minimum": 0
        },
        "totalValue": {
          "type": "number",
          "minimum": 0
        },
        "totalPnL": {
          "type": "number"
        },
        "totalPnLPercent": {
          "type": "number"
        },
        "positionCount": {
          "type": "integer",
          "minimum": 0
        }
      },
      "required": ["cash", "totalEquity"]
    },
    "holdings": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "ticker": {
            "type": "string",
            "pattern": "^[A-Z]{1,5}$"
          },
          "shares": {
            "type": "number",
            "minimum": 0
          },
          "buyPrice": {
            "type": "number",
            "minimum": 0
          },
          "currentPrice": {
            "type": "number",
            "minimum": 0
          },
          "costBasis": {
            "type": "number",
            "minimum": 0
          },
          "currentValue": {
            "type": "number",
            "minimum": 0
          },
          "pnl": {
            "type": "number"
          },
          "pnlPercent": {
            "type": "number"
          },
          "stopLoss": {
            "type": "number",
            "minimum": 0
          },
          "positionWeight": {
            "type": "number",
            "minimum": 0,
            "maximum": 100
          },
          "entryDate": {
            "type": "string",
            "format": "date"
          },
          "lastUpdated": {
            "type": "string",
            "format": "date-time"
          }
        },
        "required": ["ticker", "shares", "buyPrice", "costBasis"]
      }
    },
    "benchmarks": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "ticker": {
            "type": "string"
          },
          "name": {
            "type": "string"
          },
          "currentPrice": {
            "type": "number"
          },
          "percentChange": {
            "type": "number"
          },
          "volume": {
            "type": "number"
          }
        }
      }
    },
    "riskMetrics": {
      "type": "object",
      "properties": {
        "maxPositionWeight": {
          "type": "number",
          "minimum": 0,
          "maximum": 100
        },
        "diversificationScore": {
          "type": "string",
          "enum": ["POOR", "FAIR", "GOOD", "EXCELLENT"]
        },
        "stopLossExposure": {
          "type": "number"
        },
        "riskLevel": {
          "type": "string",
          "enum": ["LOW", "MEDIUM", "HIGH"]
        }
      }
    }
  },
  "required": ["summary", "holdings"]
}